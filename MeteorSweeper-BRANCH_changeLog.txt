2006-08-07 tsawada2 <ben-sawa@td5.so-net.ne.jp>
	* application/source/browser/CMRBrowser.m
	* application/source/thread/CMRThreadViewer.m
	* application/source/manager/CMRDocumentController.m
	* application/source/CMRAppDelegate.m
		ブラウザウインドウのカスケード処理方法を見直した。
		- カスケードしてほしいときと、してほしくないとき…この切り替えが予想以上に難しい。
		- 今まで CMRDocumentController を中心に処理していたが、CMRAppDelegate 中心に変更。
		また、CMRMainBrowser インスタンスが指しているブラウザウインドウを閉じた（dealloc した）ときは、
		今までは無条件に CMRMainBrowser を nil にしていたが、他にブラウザウインドウが開いていればそちらを
		新しい CMRMainBrowser の指し示すモノにするようにした。
	* application/Resources/Japanese.lproj/MainMenu.nib
		「スレッド」＞「印を付ける」＞「フラグ付き」を command-shift-L から command-shift-E に変更。
		- サービスメニューとアプリケーションのショートカットが衝突した場合は、アプリケーションのショートカットが
		　優先される。サービスメニュー側でぶつからないよう慎重にショートカット選べや！と突っぱねたい気もするが、
		　件の「サービス」＞「Google 検索」は Apple 提供のものであるため、事実上システム標準のショートカットと
		　同格と見なさざるを得ない。そういうわけでサービスメニュー側にこのショートカットを渋々譲ることとした。
		- Mail.app の「フラグ付き」と合わせる形で Cmd-shift-L にしていたが、無念。
		- 新しい Cmd-shift-E は、「Emphasis」の頭文字と覚えよう。
		あと、書き忘れていたが「掲示板」＞「Web ブラウザで開く」を「掲示板を Web ブラウザで開く」に変更した。
		- 「掲示板」メニューにあるのだからわざわざ「掲示板を」と付けなくてもいいのだが、かねてより
		　「スレッド」＞「Web ブラウザで開く」と表記が同じために問題を起こす場合があったので、思い切って変更した。
	* application/source/CMRAppDelegate.m
		暫定的に、「掲示板」＞「掲示板リストの同期...」を選ぶと「環境設定」＞「同期」ペインを表示する
		ようにした（今後ふるまいは変わるかもしれない）。
	* application/subproj/preference/rsrc/syncFail.tiff
	* application/subproj/preference/rsrc/syncFinish.tiff
		[新規追加]「環境設定」>「同期」ペインで使用する画像。
	* application/subproj/preference/general/BSTagValueTransformer.m
		「同期」ペインで使おうと思って NSURL <--> NSString 変換の valueTransformer を書いた（が、
		諸事情により使わないことになった）。ソースが少ないので BSTagValueTransformer.(h|m) に
		居候して書いてある。
	* application/subproj/preference/Japanese.lproj/SyncPane.nib
	* application/subproj/preference/Japanese.lproj/Localizable.strings
	* application/subproj/preference/rsrc/Sync.tiff
	* application/subproj/preference/SyncPaneController.m
	* application/subproj/preference/pane/PreferencesPane-PCManagement.m
	* application/subproj/preference/pane/PreferencesPane-Toolbar.m
	* application/subproj/preference/pane/PreferencesPane.m
	* application/subproj/preference/PreferencePanes_Prefix.h
		環境設定に「同期」ペインを追加した。BWAgent の機能（のフロントエンド）はここに統合された。
		- 注意：「自動的に同期」関連の項目は、設定はできるが実際には機能がインプリメントされていないので、
		　今のところ意味がない。
		また、環境設定パネルのツールバー項目の並び順を変更した。
	* application/source/preferences/AppDefaults-Bundle.m
	* application/source/preferences/AppDefaults.h
		掲示板リストの同期に関連する環境設定項目群を追加。
		- 注意：BWAgent.app の設定は引き継がれない。
	* application/Resources/na-na.scpt
	* application/Resources/himeko.scpt
		[新規追加] BoardWarrior クラスが使用する AppleScript（コンパイル済み）。
		- sora.pl や rosetta.pl を走らせるのに、NSTask を使えば良さそうなのだがどうもうまく使えない。
		仕方ないので、すでに実績のある BWAgent.app の AppleScript ソースの一部を再利用して、
		これを NSAppleScript を使って走らせるようにした（AppleScript の中で、do shell script 命令を
		使用して perl スクリプトを走らせている訳だ）。この程度の作業ならパフォーマンスも気にならないし、いいだろう。
	* application/source/bbs/BoardWarrior.m
		[新規追加] BoardWarrior クラスの共有インスタンスが、BWAgent.app の後継となる。
		短期間で安定した動作を得るため、極力 BWAgent.app 時代と「流れ」は変わらないように作った。つまり、
		BoardWarrior クラスは board_default.plist を作成し、board.plist を書き換えるだけである。
		それらの観察、反映等は今までどおり BoardList/CMRFileManager 等が行っている。
		また、BWAgent.app 内に含まれていた sora.pl/rosetta.pl/SJIS2UTF8 もそのまま流用した。
		- 注意：まだ自動的に同期するための機能を書いていない。
2006-08-06 tsawada2 <ben-sawa@td5.so-net.ne.jp>
	* application/source/composer/CMXTextParser.m
	* application/source/composer/CMRAttributedMessageComposer.m
	* application/Resources/Japanese.lproj/MessageComposer.strings
		Be 表示の仕様変更に対応。
		- ★を赤く表示することは、現在の BathyScaphe の内部構造上不可能であった。勘弁な。
2006-08-05 tsawada2 <ben-sawa@td5.so-net.ne.jp>
	* application/source/browser/CMRFavoritesManager.m
		2006-08-04 の変更によって、一部のお気に入り項目で「レス数」「差分」が空欄になる現象が起きているだろう。
		これは元々そのスレを「お気に入りに追加」したときに、それらの情報がなかった場合に起きる。
		- このようなケースは、2ペイン別ウインドウで開いたスレッドを「お気に入りに追加」した際に発生する。
		今までは CMRThreadsListReadFileTask - CMRThreadsUpdateListTask でこの「足りない情報」が補完されていた。
		しかし、より方法を簡素化し、かつ、確実に正しい情報を取得するために、「お気に入りを追加」するときに
		「レス数」情報がなければ、CMRFavoritesManager 側でそれを補完してから登録するように変更。
		- もちろん、既に「情報が足りない状態で」登録されているお気に入りについては力が及ばないが、「スレッドの更新」
		　を行ったり、あるいは最悪でも「いったん登録解除→再びお気に入りに追加」すれば大丈夫。
	* application/source/browser/CMRFavoritesManager.m
	* application/source/manager/CMRTrashbox.m
	* application/source/browser/CMRThreadsList-Remove.m
	* application/source/thread/CMRThreadViewer-Action.m
		お気に入りに登録されているスレッドを「削除して再取得」する際、お気に入りからは削除しないまま作業を行える
		ように新しい仕組みを導入した。CMRTrashboxDidPerformNotification に「再取得しようとしているかどうか」
		の情報を載せて運べるようにした。
	* application/source/browser/CMRBrowser-Action.m
	* application/source/browser/CMRBrowser.m
	* application/source/browser/CMRBrowser-ViewAccessor.m
	* application/Resources/Japanese.lproj/Browser.nib
	* application/source/browser/CMRThreadsList-Filter.m
	* application/source/browser/Browser.m
		なぜかスレッド一覧の検索で、絞り込まれた状態を検索語句を空にすることで解除しようとしても一覧が絞り込み解除
		されなくなっていたのを修正している途中。ついでにこのへんのソースを簡略化。
		- 副作用的な仕様変更：検索フィールドに語句が残ったまま他の板に一覧を切り替えると、検索フィールドは空になる
		　ようになった。
2006-08-04 tsawada2 <ben-sawa@td5.so-net.ne.jp>
	* application/source/browser/w2chFavoriteItemList.m
	* application/source/browser/CMRThreadsList-Remove.m
		お気に入りに登録されているスレッドの「ログを削除」したときの挙動、および「ログを削除」しても
		該当板のスレッド一覧でステータス等がクリアされないことがある問題を改善すべく取り組み中。
		また、「お気に入り」一覧の読み込みは CMRThreadsListReadFileTask を介さず直接
		CMRFavoritesManager を参照するようにした。
	* application/source/browser/CMRThreadsList-listImport.m
	* application/source/thread/CMRThreadViewer-Download.m
		メソッドまたは関数名の修正、引数の型の修正など。
	* application/source/thread/CMRThreadViewer-Validation.m
	* application/source/thread/CMRThreadViewer-Action.m
		addFavorites: が正しく動作するようにした（1.2.2 ベースに戻した）。
		同様に、addFavorites: に対する validation が正しく動作するように戻した。
2006-08-03 tsawada2 <ben-sawa@td5.so-net.ne.jp>
	* application/subproj/preference/general/GeneralPrefController.m
	* application/subproj/preference/Japanese.lproj/GeneralPreferences.nib
		「一般」ペインで、（実験的に）直接 AppDefaults と各 UI を bind させる方法を大幅に取り入れた。
		- 今まで：各 UI <--bind--> GeneralPrefController <--Accessor Methods--> AppDefaults
		- これから：各 UI <--bind--> NSObjectController(selection object: AppDefaults)
		「一般」ペインでの成績が良好なら順次他のペインにもこの仕組みを取り入れていく。
	* application/subproj/preference/pane/PreferencesPane.m
		BSTagValueTransformer を initWithPreferences: のタイミングで登録。
		- nib がロードされる前に登録しないと間に合わない！
	* application/subproj/preference/general/BSTagValueTransformer.(h|m)
		[新規追加] Cocoa Binding 用のちょっとした Value Transformer。
		- メニューアイテムの tag と、設定の値（integer）を bind させたいのだが、設定値 = NSNotFound のとき
		　だけは tag "-1" と bind させたい。その値変換を行うもの。
	* application/source/thread/CMRThreadViewer.m
		記法の修正。
	* application/source/window/CMRStatusLineWindowController.h
		application/source/window/CMRStatusLineWindowController_p.h と統合。_p.h はターゲットから
		外した。_p.h を import していたいくつかのファイルをそれに伴い修正。
2006-08-01 tsawada2 <ben-sawa@td5.so-net.ne.jp>
	* application/source/thread/CMRThreadViewer-ViewAccessor.m
	* application/source/browser/CMRBrowser-Delegate.m
		ブラウザウインドウで、2ペインと3ペインを切り替えた際に、スレッドナビゲーションの表示／非表示を
		切り替える作業が行われないケースがあったのを修正。
	* application/subproj/previewer/BSImagePreviewInspector-Tb.m
	* application/subproj/previewer/BSIPIAppKitExtensions.(h|m)
		プレビューインスペクタ（2.0.5→2.0.6）：
		- BSSegmentedControlTbItem クラスを BSIPISegmentedControlTbItem に名称変更した。
		- BathyScaphe 1.2.2 以前では、BathyScaphe.app 本体に BSSegmentedControlTbItem
		  クラスが存在する。これはプレビューインスペクタ 2.0.x で使っているものより古いクラスで、
		  互換性がない。ところが、プレビューインスペクタは BathyScaphe に読み込まれて動作するため、
		  その互換性のない古い BSSegmentedControlTbItem クラスが優先して使われてしまうようだ。
		  このため、クラス名を変更した。
		- BathyScaphe 1.3 以降に限定する場合は、このようなことは必要ないのだが。
2006-07-31 tsawada2 <ben-sawa@td5.so-net.ne.jp>
	* application/subproj/previewer/BSImagePreviewInspector-View.m
	* application/subproj/previewer/BSImagePreviewInspector-Tb.m
	* application/subproj/previewer/BSImagePreviewInspector.m
	* application/subproj/previewer/BSIPIHistoryManager.m
		プレビューインスペクタ（2.0.4→2.0.5）：
		- SGFoundation, SGAppKit, CocoMonar Framework にリンクしないようにした。
		- これらのフレームワークに含まれていた必要なクラス、カテゴリは自前で用意（下の
		　新規追加したファイル）することにした。
	* application/subproj/previewer/BSIPIFoundationExtensions.(h|m)
	* application/subproj/previewer/BSIPIAppKitExtensions.(h|m)
		[新規追加]いくつかの必要なカテゴリ、カスタムクラスをまとめたユーティリティ。
    * application/Makefile
        ビルドターゲットを bs another story から bathyscaphe に変更
        （トランクから持ってきたのでそうなっていた）。
    * application/BathyScaphe.xcodeproj/project.pbxproj
        とりあえず MeteorSweeper のためだけのブランチなので、他のターゲットや
        不要なソースへの参照を削除して混乱を防ぐようにした。
    * application/Resources/Japanese.lproj/InfoPlist.strings
        ローカライズされたバージョン文字列を 1.3 ベースに更新。
    * application/Resources/Japanese.lproj/MainMenu.nib
        トランクから取ってきたものは「ウインドウ」＞「ログ管理」が抹消されていたので、復帰。
    * application/Resources/Japanese.lproj/AddBoardSheet.nib
        1.2.2 のものに差し替え。
    * application/source/libRBSplitView.a
        ranlib し直した。
    * application/source/main.m
    * application/source/bbs/BoardList-OVDataSource.m
    * application/source/browser/AddBoardSheetController.(h|m)
    * application/source/browser/CMRBrowser-Action.m
    * application/source/browser/CMRBrowser-BLEditor.m
    * application/source/browser/CMRBrowser-Delegate.m
    * application/source/browser/CMRBrowser-List.m
    * application/source/browser/CMRBrowser-Validation.m
    * application/source/browser/CMRBrowser-ViewAccessor.m
    * application/source/browser/CMRBrowser_p.h
        ビルドが通るように、v120-BASED-BRANCH のものと差し替えたり、一部コメントアウト
        したりした。
    * application/source/thread/CMRThreadViewer-Action.m
    * application/source/thread/CMRThreadViewer-Validation.m
        とりあえずビルドだけ通るようにコメントアウトなど。後で直す。
    * frameworks/Makefile
        KeyChain.framework は make しません。
	* application/source/bbs/BoardList-OVDataSource.m
	* application/source/bbs/BoardManager_p.h
	* application/source/bbs/BoardManager-BSAddition.m
	* application/source/bbs/BoardManager.(h|m)
	* application/source/browser/Browser.m
	* application/source/browser/BSFavoritesHEADCheckTask.m
	* application/source/browser/CMRFavoritesManager.(h|m)
	* application/source/browser/CMRThreadsList-Download.m
	* application/source/browser/CMRThreadsList-listImport.m
	* application/source/browser/CMRThreadsList-Notification.m
	* application/source/browser/CMRThreadsList-Remove.m
	* application/source/browser/CMRThreadsListReadFileTask.m
	* application/source/browser/CMRThreadsUpdateListTask.m
		v120-BASED-BRANCH の先端から丸ごとこれらのファイルを差し替え。
		とりあえず 1.2.2 ベースの動作に戻すため。もちろん、他にも何カ所か擦り合わせが必要。
	* MeteorSweeper-BRANCH_changeLog.txt
		[新規追加]このブランチ用の changeLog.txt (UTF-8)。
2006-07-31 tsawada2 <ben-sawa@td5.so-net.ne.jp>
	*トランクから分岐。
	 - トランク上の分岐点目印タグ：Root-of-MeteorSweeper
	 - ブランチタグ：MeteorSweeper-BRANCH